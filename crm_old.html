<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Imobiliar - Gestiune Proprietăți</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {font-family: 'Inter', sans-serif;background-color: #f7f9fc;}
        .search-field {padding: 10px;border: 1px solid #d1d5db;border-radius: 8px;transition: all 0.2s;width: 100%;}
        .search-field:focus {border-color: #3b82f6;box-shadow: 0 0 0 3px rgba(59,130,246,0.5);outline: none;}
        #edit-modal {display: none;}
        .grid-container {display: grid;gap: 0;}
        .grid-container {grid-template-columns: minmax(120px,1fr) 160px minmax(200px,1.5fr) minmax(200px,2fr) minmax(160px,1.6fr) minmax(150px,1.5fr) minmax(100px,1fr);}
        @media (max-width: 1024px) {
            .grid-container {grid-template-columns: minmax(100px,1fr) 100px minmax(150px,2fr) minmax(100px,1fr);}
            .lg-only {display: none !important;}
        }
        .grid-header {font-weight: 600;color: #4b5563;padding: 12px 0;border-bottom: 2px solid #e5e7eb;display: contents;}
        .grid-header > div {padding: 8px 0;}
        .grid-row {border-bottom: 1px solid #f3f4f6;cursor: pointer;display: contents;}
        .grid-row:hover > div:not(.inline-edit) {background-color: #f0f4f8;}
        .grid-row > div {padding: 12px 0;}
        .inline-edit {
            grid-column: 1 / -1;
            display: none;
            background: #f9fafb;
            border-top: 2px solid #3b82f6;
            padding: 20px 0;
            margin-top: 12px;
        }
        .grid-row.expanded .inline-edit {display: block;}
    </style>
</head>
<body class="p-4 sm:p-8">


		<!-- TOP MENU BAR – Fixed at the very top, works on all pages -->
<div class="fixed inset-x-0 top-0 z-50">
    <div class="bg-white shadow-lg border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">

                <!-- Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center text-white font-bold text-xl">H</div>
                        <span class="text-xl font-bold text-gray-800 hidden sm:block">Real Estate</span>
                    </a>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#" class="text-gray-700 hover:text-indigo-600 font-medium transition">Contact Us</a>
                    <a href="#" class="text-gray-700 hover:text-indigo-600 font-medium transition">Educational</a>
                    <a href="#" class="text-gray-700 hover:text-indigo-600 font-medium transition">Profesionisti</a>
                    <a href="#" class="text-gray-700 hover:text-indigo-600 font-medium transition">Analiza De Piata</a>
                    <a href="index.html" class="text-gray-700 hover:text-indigo-600 font-medium transition">Buy</a>
                    <a href="index.html" class="text-gray-700 hover:text-indigo-600 font-medium transition">Rent</a>
                    <a href="profil.html" class="text-gray-700 hover:text-indigo-600 font-medium transition">Profilul meu</a>
                    <a href="agenti.html" class="text-gray-700 hover:text-indigo-600 font-medium transition">Find an Agent</a>
                    <a href="crm.html" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-2.5 rounded-lg transition shadow-md">Login</a>
                </div>             
            </div>
        </div>
    </div>
</div>

<!-- This tiny padding pushes your page content below the fixed menu -->
<div class="pt-20"></div>


<div class="max-w-7xl mx-auto w-full">
    <header class="mb-8 p-4 bg-white shadow-lg rounded-xl flex justify-between items-center">
        <h1 class="text-3xl font-bold text-gray-800">Backend Agent</h1>
        <div class="text-sm text-gray-600">Utilizator Mockup: <span class="font-medium text-blue-600">agent_demo_123456</span></div>
    </header>

    <div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
        <div class="flex items-center mb-6">
            <div class="flex flex-grow" id="main-tabs">
                <button data-tab="my" class="tab-button py-2 px-4 text-sm font-medium border-b-2 border-indigo-600 text-indigo-600 bg-indigo-50/50">Listările Mele (<span id="property-count">0</span>)</button>
                <button data-tab="office" class="tab-button py-2 px-4 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Listările Biroului</button>
                <button data-tab="county" class="tab-button py-2 px-4 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">Listările Agenților din Județ</button>
                <div class="flex-grow"></div>
            </div>
            <button id="add-property-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition ml-4">
                + Adaugă Proprietate Nouă
            </button>
        </div>
        <div class="border-b border-gray-200 -mt-3 mb-6"></div>

        <div id="grid-header" class="grid-container grid-header lg:grid hidden">
            <div class="header-dropdown-container">Status</div>
            <div>Poza</div>
            <div class="lg-only">Caracteristici</div>
            <div class="lg-only header-dropdown-container">Adresa</div>
            <div class="lg-only">Proprietar</div>
            <div class="header-dropdown-container">Preț</div>
            <div class="lg-only">Promovare</div>
        </div>

        <div id="property-list-container" class="grid-container"></div>
        <p id="no-results" class="text-center text-gray-500 hidden mt-8">Nu au fost găsite proprietăți care să corespundă filtrelor.</p>
    </div>
</div>

<script>
    const STATUS_OPTIONS = ['Incomplet','În lucru','Activ','Tranzacționat','Retras'];
    const TRANSACTION_TYPES = ['Vânzare','Închiriere'];
    const PROPERTY_TYPES = ['Apartament','Casă','Teren','Birou'];
    let activeFilters = {status:new Set(STATUS_OPTIONS),transaction:new Set(TRANSACTION_TYPES),location:'',priceMin:0,priceMax:Infinity};
    let activeTab = 'my';

    const MOCKUP_PROPERTIES = [ /* întregul array rămâne neschimbat */ 
			{ id: 'p1', status: 'Activ', type: 'Apartament', transaction: 'Vânzare', title: 'Ap. 2 cam. Ultra-central, Et. 3', location: 'Cluj-Napoca', zone: 'Ultracentrală', county: 'Cluj', country: 'România', price: 120000, commissionPercent: 3, collaborationCommission: 1.5, commissionValue: 3600, area: 55, rooms: 2, floor: 3, yearBuilt: 1985, description: 'Apartament excelent renovat, vedere panoramică.', portals: ['Imobiliare.ro', 'Storia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Eroilor, Nr. 15', ownerType: 'me',addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro' },
		    { id: 'p3', status: 'În lucru', type: 'Teren', transaction: 'Vânzare', title: 'Teren intravilan 800mp', location: 'Gilău', zone: 'Zona Industrială', county: 'Cluj', country: 'România', price: 80000, commissionPercent: 4, collaborationCommission: 2.0, commissionValue: 3200, area: 800, rooms: 0, floor: 0, yearBuilt: 0, description: 'Teren ideal pentru depozit sau hală de producție.', portals: ['Storia'], mainImage: 'https://placehold.co/160x90/f97316/ffffff?text=LUCRU', addressExact: 'DJ107A, km 5', ownerType: 'me',addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro' },
            { id: 'p7', status: 'Incomplet', type: 'Apartament', transaction: 'Vânzare', title: 'Ap. 3 cam. Mărăști, de renovat', location: 'Cluj-Napoca', zone: 'Mărăști', county: 'Cluj', country: 'România', price: 95000, commissionPercent: 3.5, collaborationCommission: 1.0, commissionValue: 3325, area: 70, rooms: 3, floor: 4, yearBuilt: 1978, description: 'Necesită renovare completă, potențial mare.', portals: [], mainImage: 'https://placehold.co/160x90/f59e0b/ffffff?text=INCOMPL', addressExact: 'Str. Aurel Vlaicu, Bl. 10', ownerType: 'me',addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro' },
            // Adăugiri
            { id: 'p10', status: 'Activ', type: 'Apartament', transaction: 'Închiriere', title: 'Studio modern, Bloc Nou', location: 'Cluj-Napoca', zone: 'Bună Ziua', county: 'Cluj', country: 'România', price: 400, commissionPercent: 100, collaborationCommission: 50, commissionValue: 400, area: 40, rooms: 1, floor: 5, yearBuilt: 2022, description: 'Studio complet mobilat și utilat, disponibil imediat.', portals: ['Imobiliare.ro', 'Publi24'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Fabricii', ownerType: 'me',addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro' },
            { id: 'p11', status: 'În lucru', type: 'Casă', transaction: 'Vânzare', title: 'Casă 5 cam. Florești, de finisat', location: 'Florești', zone: 'Cetate', county: 'Cluj', country: 'România', price: 180000, commissionPercent: 2.5, collaborationCommission: 1.5, commissionValue: 4500, area: 150, rooms: 5, floor: 1, yearBuilt: 2020, description: 'Casă P+E, interior la gri, exterior finisat.', portals: ['Storia'], mainImage: 'https://placehold.co/160x90/f97316/ffffff?text=LUCRU', addressExact: 'Str. Florilor, Nr. 5', ownerType: 'me' ,addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro'},
            { id: 'p12', status: 'Activ', type: 'Teren', transaction: 'Vânzare', title: 'Teren Construibil 1200mp, Gilău', location: 'Gilău', zone: 'Lângă Pădure', county: 'Cluj', country: 'România', price: 100000, commissionPercent: 3, collaborationCommission: 1.5, commissionValue: 3000, area: 1200, rooms: 0, floor: 0, yearBuilt: 0, description: 'Teren cu PUZ aprobat pentru locuințe.', portals: ['Olimpia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Drumul Principal', ownerType: 'me' },
            { id: 'p13', status: 'Tranzacționat', type: 'Apartament', transaction: 'Vânzare', title: 'Ap. 2 cam. Gheorgheni, vandut rapid', location: 'Cluj-Napoca', zone: 'Gheorgheni', county: 'Cluj', country: 'România', price: 110000, commissionPercent: 3, collaborationCommission: 0.5, commissionValue: 3300, area: 50, rooms: 2, floor: 8, yearBuilt: 1990, description: 'Tranzacționat în 7 zile.', portals: ['Imobiliare.ro'], mainImage: 'https://placehold.co/160x90/ef4444/ffffff?text=VANDUT', addressExact: 'Str. Liviu Rebreanu', ownerType: 'me' ,addedDate:'15.11.2025',ownerName:'Popescu Ion',ownerPhone:'0722 123 456',ownerEmail:'ion@email.ro'},
            
            // ====================================================================================================
            // Listările Biroului (ownerType: 'office') - 7 Proprietăți
            // ====================================================================================================
            { id: 'p2', status: 'Tranzacționat', type: 'Casă', transaction: 'Vânzare', title: 'Casă 4 cam. curte 500mp', location: 'Florești', zone: 'Centru Florești', county: 'Cluj', country: 'România', price: 210000, commissionPercent: 2.5, collaborationCommission: 1.0, commissionValue: 5250, area: 120, rooms: 4, floor: 0, yearBuilt: 2018, description: 'Casă individuală, finisaje premium, mutare imediată.', portals: ['Imobiliare.ro'], mainImage: 'https://placehold.co/160x90/ef4444/ffffff?text=VANDUT', addressExact: 'Str. Principală, Nr. 200', ownerType: 'office',addedDate:'15.11.2025' },
            { id: 'p5', status: 'Retras', type: 'Birou', transaction: 'Închiriere', title: 'Spațiu Birouri 100mp', location: 'București', zone: 'Piata Victoriei', county: 'București', country: 'România', price: 1200, commissionPercent: 100, collaborationCommission: 50, commissionValue: 1200, area: 100, rooms: 3, floor: 1, yearBuilt: 2005, description: 'Spațiu de birouri open-space, ideal pentru IT.', portals: [], mainImage: 'https://placehold.co/160x90/6b7280/ffffff?text=RETRAS', addressExact: 'Bd. Iancu de Hunedoara, Nr. 4', ownerType: 'office',addedDate:'15.11.2025' },
            { id: 'p8', status: 'Activ', type: 'Apartament', transaction: 'Închiriere', title: 'Garsonieră Centrală, Mobilată', location: 'Cluj-Napoca', zone: 'Central', county: 'Cluj', country: 'România', price: 350, commissionPercent: 100, collaborationCommission: 50, commissionValue: 350, area: 35, rooms: 1, floor: 2, yearBuilt: 2000, description: 'Garsonieră excelentă pentru studenți.', portals: ['Publi24'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Bd. 21 Decembrie 1989', ownerType: 'office' ,addedDate:'15.11.2025'},
            // Adăugiri
            { id: 'p14', status: 'Activ', type: 'Birou', transaction: 'Închiriere', title: 'Clădire Birouri Clasa A, 500mp', location: 'București', zone: 'Aviației', county: 'București', country: 'România', price: 8000, commissionPercent: 100, collaborationCommission: 50, commissionValue: 8000, area: 500, rooms: 10, floor: 3, yearBuilt: 2015, description: 'Spațiu modern, etaj întreg, parcare inclusă.', portals: ['Imobiliare.ro', 'Storia', 'Olimpia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Unirii', ownerType: 'office',addedDate:'15.11.2025' },
            { id: 'p15', status: 'Incomplet', type: 'Apartament', transaction: 'Vânzare', title: 'Ap. 4 cam. de lux, Timișoara', location: 'Timișoara', zone: 'Central', county: 'Timiș', country: 'România', price: 250000, commissionPercent: 2.0, collaborationCommission: 1.0, commissionValue: 5000, area: 100, rooms: 4, floor: 7, yearBuilt: 2019, description: 'Apartament finisat premium, descriere în așteptare.', portals: ['Imobiliare.ro'], mainImage: 'https://placehold.co/160x90/f59e0b/ffffff?text=INCOMPL', addressExact: 'Bd. Revoluției', ownerType: 'office',addedDate:'15.11.2025' },
            { id: 'p16', status: 'Retras', type: 'Casă', transaction: 'Vânzare', title: 'Casă veche de renovat, Sibiu', location: 'Sibiu', zone: 'Turnișor', county: 'Sibiu', country: 'România', price: 90000, commissionPercent: 3, collaborationCommission: 1.5, commissionValue: 2700, area: 80, rooms: 3, floor: 0, yearBuilt: 1950, description: 'Retrasă temporar de la vânzare, necesită renovare.', portals: [], mainImage: 'https://placehold.co/160x90/6b7280/ffffff?text=RETRAS', addressExact: 'Str. Ocnei', ownerType: 'office' ,addedDate:'15.11.2025'},
            { id: 'p17', status: 'Activ', type: 'Apartament', transaction: 'Închiriere', title: 'Apartament 2 cam, Zorilor', location: 'Cluj-Napoca', zone: 'Zorilor', county: 'Cluj', country: 'România', price: 550, commissionPercent: 100, collaborationCommission: 50, commissionValue: 550, area: 50, rooms: 2, floor: 4, yearBuilt: 1988, description: 'Apartament mobilat și utilat complet.', portals: ['Storia', 'Publi24'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Observatorului', ownerType: 'office',addedDate:'15.11.2025' },

            // ====================================================================================================
            // Listările Agenților din Județ (ownerType: 'county') - 7 Proprietăți
            // ====================================================================================================
            { id: 'p4', status: 'Activ', type: 'Apartament', transaction: 'Închiriere', title: 'Studio modern, Bloc Nou', location: 'Timișoara', zone: 'Zona Iulius Mall', county: 'Timiș', country: 'România', price: 400, commissionPercent: 50, collaborationCommission: 50, commissionValue: 200, area: 40, rooms: 1, floor: 5, yearBuilt: 2021, description: 'Studio complet mobilat și utilat, disponibil imediat.', portals: ['Imobiliare.ro', 'Olimpia', 'Publi24'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Calea Aradului, Nr. 5', ownerType: 'county',addedDate:'15.11.2025' },
            { id: 'p6', status: 'Activ', type: 'Casă', transaction: 'Vânzare', title: 'Vilă P+1, 5 camere, Grădină', location: 'Iași', zone: 'Copou', county: 'Iași', country: 'România', price: 350000, commissionPercent: 2.0, collaborationCommission: 1.0, commissionValue: 7000, area: 180, rooms: 5, floor: 1, yearBuilt: 2015, description: 'Vilă de lux cu piscină interioară.', portals: ['Imobiliare.ro', 'Olimpia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Sărăriei, Nr. 12', ownerType: 'county',addedDate:'15.11.2025' },
            { id: 'p9', status: 'Incomplet', type: 'Teren', transaction: 'Vânzare', title: 'Teren Construibil Sibiu', location: 'Sibiu', zone: 'Calea Cisnădiei', county: 'Sibiu', country: 'România', price: 50000, commissionPercent: 4, collaborationCommission: 2, commissionValue: 2000, area: 500, rooms: 0, floor: 0, yearBuilt: 0, description: 'Teren ideal pentru casă P+1.', portals: [], mainImage: 'https://placehold.co/160x90/f59e0b/ffffff?text=INCOMPL', addressExact: 'Str. Luncii', ownerType: 'county' ,addedDate:'15.11.2025'},
            // Adăugiri
            { id: 'p18', status: 'Activ', type: 'Teren', transaction: 'Vânzare', title: 'Teren 700mp, Brașov', location: 'Brașov', zone: 'Stupini', county: 'Brașov', country: 'România', price: 75000, commissionPercent: 3.5, collaborationCommission: 1.5, commissionValue: 2625, area: 700, rooms: 0, floor: 0, yearBuilt: 0, description: 'Teren intravilan, utilități aproape.', portals: ['Storia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Str. Stupinii, Nr. 10', ownerType: 'county' ,addedDate:'15.11.2025'},
            { id: 'p19', status: 'În lucru', type: 'Apartament', transaction: 'Vânzare', title: 'Ap. 3 cam. Constanța, vedere mare', location: 'Constanța', zone: 'Faleză Nord', county: 'Constanța', country: 'România', price: 150000, commissionPercent: 2.5, collaborationCommission: 1.0, commissionValue: 3750, area: 85, rooms: 3, floor: 9, yearBuilt: 2010, description: 'Bloc nou, se așteaptă documentația finală.', portals: ['Imobiliare.ro'], mainImage: 'https://placehold.co/160x90/f97316/ffffff?text=LUCRU', addressExact: 'Bd. Mamaia, Bl. D5', ownerType: 'county',addedDate:'15.11.2025' },
            { id: 'p20', status: 'Tranzacționat', type: 'Casă', transaction: 'Vânzare', title: 'Vilă tip Duplex, Oradea', location: 'Oradea', zone: 'Nufărul', county: 'Bihor', country: 'România', price: 140000, commissionPercent: 3, collaborationCommission: 1.5, commissionValue: 4200, area: 110, rooms: 4, floor: 1, yearBuilt: 2017, description: 'Vândută în colaborare cu agent local.', portals: ['Olimpia', 'Publi24'], mainImage: 'https://placehold.co/160x90/ef4444/ffffff?text=VANDUT', addressExact: 'Str. Salcâmilor, Nr. 3', ownerType: 'county',addedDate:'15.11.2025' },
            { id: 'p21', status: 'Activ', type: 'Birou', transaction: 'Închiriere', title: 'Spațiu Comercial 80mp, Iași', location: 'Iași', zone: 'Centru Civic', county: 'Iași', country: 'România', price: 900, commissionPercent: 100, collaborationCommission: 50, commissionValue: 900, area: 80, rooms: 2, floor: 0, yearBuilt: 1995, description: 'Ideal pentru clinică sau magazin, vad bun.', portals: ['Imobiliare.ro', 'Storia'], mainImage: 'https://placehold.co/160x90/22c55e/ffffff?text=ACTIV', addressExact: 'Bd. Ștefan cel Mare', ownerType: 'county',addedDate:'15.11.2025' },
    ];

    const container = document.getElementById('property-list-container');
    const header = document.getElementById('grid-header');
    const noResults = document.getElementById('no-results');
    const countSpan = document.getElementById('property-count');

    function generateInlineEditForm(property) {
        return `
            <div class="inline-edit p-6">
                <h4 class="text-xl font-bold text-gray-700 mb-4">Editare Rapidă: ${property.title}</h4>
                <form class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <input type="hidden" name="property-id" value="${property.id}">
                    <div class="col-span-2 md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-1">Status</label><select name="status" class="search-field py-2" required>${STATUS_OPTIONS.map(s=>`<option value="${s}" ${s===property.status?'selected':''}>${s}</option>`).join('')}</select></div>
                    <div class="col-span-4 md:col-span-3 lg:col-span-3"><label class="block text-sm font-medium text-gray-700 mb-1">Titlu</label><input type="text" name="title" class="search-field py-2" value="${property.title||''}" required></div>
                    <div class="col-span-2 md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-1">Tip</label><select name="type" class="search-field py-2" required>${PROPERTY_TYPES.map(t=>`<option value="${t}" ${t===property.type?'selected':''}>${t}</option>`).join('')}</select></div>
                    <div class="col-span-2 md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-1">Tranzacție</label><select name="transaction" class="search-field py-2" required>${TRANSACTION_TYPES.map(t=>`<option value="${t}" ${t===property.transaction?'selected':''}>${t}</option>`).join('')}</select></div>
                    <div class="col-span-2 md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Preț (€)</label><input type="number" name="price" class="search-field py-2" value="${property.price||0}" required></div>
                    <div class="col-span-2 md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-1">Suprafață (mp)</label><input type="number" name="area" class="search-field py-2" value="${property.area||0}" required></div>
                    <div class="col-span-2 md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-1">Camere</label><input type="number" name="rooms" class="search-field py-2" value="${property.rooms||0}" required></div>
                    <div class="col-span-4 lg:col-span-4"><label class="block text-sm font-medium text-gray-700 mb-1">Adresă Exactă</label><input type="text" name="addressExact" class="search-field py-2" value="${property.addressExact||''}" required></div>
                    <div class="col-span-6"><label class="block text-sm font-medium text-gray-700 mb-1">Descriere</label><textarea name="description" rows="2" class="search-field py-2 resize-none">${property.description||''}</textarea></div>
                    <div class="col-span-6 flex justify-end space-x-3 mt-4">
                        <button type="button" class="inline-delete-btn bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg">Șterge (Mock)</button>
                        <button type="button" class="inline-save-btn bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg">Salvează (Mock)</button>
                        <button type="button" class="inline-cancel-btn bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">Anulează</button>
                    </div>
                </form>
            </div>
        `;
    }

    function render(props) {
        container.innerHTML = '';
        if (activeTab === 'my') countSpan.textContent = props.length;
        if (props.length === 0) { noResults.classList.remove('hidden'); header.classList.add('hidden'); return; }
        noResults.classList.add('hidden'); header.classList.remove('hidden');

        props.forEach(p => {
            const commission = p.commissionValue ? `${p.commissionValue.toLocaleString('ro-RO')} € (${p.commissionPercent}%)` : '—';
            const collab = p.collaborationCommission ? `Colab. ${p.collaborationCommission}%` : '';

            const row = document.createElement('div');
            row.className = 'grid-row';
            row.dataset.id = p.id;
            row.innerHTML = `
                <div class="truncate pr-2"><span class="text-xs font-semibold px-2 py-0.5 rounded-full border ${getStatusStyle(p.status)}">${p.status}</span><div class="text-xs text-gray-500 mt-1">Adăugată: ${p.addedDate||'—'}</div></div>
                <div class="flex justify-center"><img src="${p.mainImage||'https://placehold.co/160x90/cccccc/333333?text=N/A'}" class="w-40 h-[90px] object-cover rounded-md shadow-md" onerror="this.src='https://placehold.co/160x90/cccccc/333333?text=N/A'"></div>
                <div class="lg-only text-sm text-gray-600"><span class="font-medium text-indigo-600">${p.type}</span><br><strong>${p.area||0} mp</strong> | ${p.rooms||0} camere<br>Etaj: ${p.floor??'—'} | An: ${p.yearBuilt||'—'}</div>
                <div class="lg-only text-sm text-gray-600"><span class="font-medium">${p.location}, ${p.county}</span><br><span class="text-xs text-gray-500">${p.addressExact||'—'}, ${p.zone||''}</span></div>
                <div class="lg-only text-sm text-gray-700"><div class="font-medium">${p.ownerName||'—'}</div><div class="text-xs">${p.ownerPhone||''}</div><div class="text-xs text-blue-600">${p.ownerEmail||''}</div></div>
                <div><div class="text-lg font-bold text-indigo-600">${p.price.toLocaleString('ro-RO')} €</div><div class="text-xs text-gray-600">Comision: ${commission}</div><div class="text-xs text-blue-500">${collab}</div><div class="text-xs text-blue-600 font-medium mt-1">${p.transaction}</div></div>
                <div class="lg-only flex flex-col space-y-0.5">${(p.portals||[]).map(po=>`<div class="flex items-center"><span class="h-3 w-3 mr-1 text-green-500">✓</span><span class="text-xs text-gray-700">${po}</span></div>`).join('')||'<span class="text-xs text-gray-400">Niciun portal</span>'}</div>
                ${generateInlineEditForm(p)}
            `;
            container.appendChild(row);
        });

        // LOGICĂ EXPAND / EDIT INLINE – REPARAT
        document.querySelectorAll('.grid-row').forEach(row => {
            row.addEventListener('click', (e) => {
                // Oprim propagarea dacă click-ul vine din interiorul formularului inline
                if (e.target.closest('.inline-edit')) return;

                document.querySelectorAll('.grid-row.expanded').forEach(r => r !== row && r.classList.remove('expanded'));
                row.classList.toggle('expanded');

                if (row.classList.contains('expanded')) {
                    const saveBtn   = row.querySelector('.inline-save-btn');
                    const deleteBtn = row.querySelector('.inline-delete-btn');
                    const cancelBtn = row.querySelector('.inline-cancel-btn');

                    saveBtn.onclick   = ev => { ev.stopPropagation(); alert(`Proprietatea ${row.dataset.id} salvată (Mock)!`); row.classList.remove('expanded'); };
                    deleteBtn.onclick = ev => { ev.stopPropagation(); if(confirm('Ștergi proprietatea?')) { row.remove(); filterAndRender(); } };
                    cancelBtn.onclick = ev => { ev.stopPropagation(); row.classList.remove('expanded'); };
                }
            });

            // Oprim complet propagarea pe toată zona inline (input-uri, select-uri, butoane etc.)
            const inline = row.querySelector('.inline-edit');
            if (inline) {
                inline.addEventListener('click', ev => ev.stopPropagation());
            }
        });
    }

    function getStatusStyle(s){
        const map = {'Activ':'bg-green-500/10 text-green-700 border-green-500','În lucru':'bg-yellow-500/10 text-yellow-700 border-yellow-500','Tranzacționat':'bg-red-500/10 text-red-700 border-red-500','Retras':'bg-gray-500/10 text-gray-700 border-gray-500'};
        return map[s] || 'bg-blue-500/10 text-blue-700 border-blue-500';
    }

    function filterAndRender(){
        const list = activeTab==='my'?MOCKUP_PROPERTIES.filter(p=>p.ownerType==='me'):
                     activeTab==='office'?MOCKUP_PROPERTIES.filter(p=>p.ownerType==='office'):
                     MOCKUP_PROPERTIES.filter(p=>p.ownerType==='county');

        const filtered = list.filter(p=>
            activeFilters.status.has(p.status) &&
            activeFilters.transaction.has(p.transaction) &&
            (!activeFilters.location || JSON.stringify(p).toLowerCase().includes(activeFilters.location)) &&
            p.price >= activeFilters.priceMin && p.price <= activeFilters.priceMax
        );
        render(filtered);
    }

    function setTab(t){
        if(activeTab===t) return;
        activeTab = t;
        document.querySelectorAll('.tab-button').forEach(b=>{
            b.classList.toggle('border-indigo-600', b.dataset.tab===t);
            b.classList.toggle('text-indigo-600', b.dataset.tab===t);
            b.classList.toggle('bg-indigo-50/50', b.dataset.tab===t);
            b.classList.toggle('border-transparent', b.dataset.tab!==t);
            b.classList.toggle('text-gray-500', b.dataset.tab!==t);
        });
        filterAndRender();
    }

    document.addEventListener('DOMContentLoaded',()=>{
        document.querySelectorAll('.tab-button').forEach(b=>b.addEventListener('click',e=>setTab(e.target.dataset.tab)));
        filterAndRender();
    });
</script>
</body>
</html>